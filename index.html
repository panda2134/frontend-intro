<!DOCTYPE html>
<html>
  <head>
    <!-- This is normalize.css, used to reset browser-specific styles. -->
    <link rel="stylesheet" href="style/normalize.css">
    <!-- Fonts -->
    <link rel="stylesheet" href="fonts/fonts.css">
    <!-- Main css for this site -->
    <link rel="stylesheet" href="style/main.css">
    <!-- CSS For Highlight.js -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.2/build/styles/atom-one-dark.min.css">
    <!-- CSS For KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css" integrity="sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5" crossorigin="anonymous">
    <!-- FavIcon -->
    <link rel="shortcut icon" href="favicon.png">
    <title>Frontend Intro</title>
  </head>
  <body>
    <header>
      <h1>Frontend Intro</h1>
    </header>
    <section>
      <h2>HTML5 Tags</h2>
      <p>
        Every single beginner loves copy-pasting HTML code from the web. I don't think that's wrong, actually.
        However, one should pay more attention to "where the code comes from".
      </p>
      <p>
        Ask yourself several questions next time before pressing <kbd>Ctrl</kbd> + <kbd>C</kbd> and <kbd>Ctrl</kbd> + <kbd>V</kbd> 's:
        <ol>
          <li>Is the code reviewed (if not recommended) by coding gurus?</li>
          <li>When was the code written? Frontend technologies evolves at lightning speed, and the code you found can be outdated.</li>
          <li>does it contain <i>depreciated</i> usage of APIs / HTML tags? (e.g. <code>&lt;marquee&gt;</code>, <code>&lt;center&gt;</code>, ...)</li>
        </ol>
      </p>
      <p>
        Personally speaking, I'm strongly against copying HTML code from some public blog site (especially Wordpress and CSDN).
        That's because experienced frontend engineers tend to run their own blog sites.
        <a href="https://stackoverflow.com">StackOverflow</a> is a good place for green hands, since answers there are selected and edited by pros.
      </p>
      <p>
        For details about HTML5 tags, do not hesitate to refer to <a href="https://developer.mozilla.org/">Mozilla Developer Network</a>.
        Articles there are eagerly translated into dozens of languages (including Chinese) by volunteers, so language won't be a problem.
      </p>
      <h3>stop using div tags everywhere</h3>
      <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/div">MDN Docs</a> describe div as a generic container for flow content.
      In the years before HTML5, it had been used as a container for literally anything. However, this is not a good practice because HTML5 introduced content sectioning tags.
      
      Take a look at <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element#content_sectioning">those elements</a> on MDN.
      
      <section class="practice" id="htmlTagsPractice">
        <h4>Try it yourself!</h4>

        Design a blog landing page. The page contains a header (with a h1 title inside), 2 articles and a footer (containing copyright notices, etc).
        <br>
        Note: articles should be wrapped by a <code>main</code> tag. You only need to code the parts inside <code>body</code> tag.

        <textarea class="target"></textarea>
        <button>Check your answer</button>
        <span class="hint"></span>
      </section>
    </section>

    <section>
      <h2>Devtools</h2>
      In this section, I assume that you're using Google Chrome or Mozilla Firefox.
      The new Microsoft Edge also works in most cases, since it's a chromium-based browser.
      <h3>How to open</h3>
      <ul>
        <li>Windows/Linux: <kbd>F12</kbd></li>
        <li>Mac OS: <kbd>‚å•</kbd>+<kbd>‚åò</kbd>+<kbd>I</kbd></li>
      </ul>
      <section class="practice" id="devTools1Practice">
        <h4>Try it yourself!</h4>

        Use devtools to modify the list below. Replace the second item with "Tacos".

        <div class="target">
          Lunch
          <ul>
            <li>Sandwich</li>
            <li>French fries</li>
            <li>Spaghetti</li>
          </ul>
        </div>

        <button>Check your answer</button>
        <span class="hint"></span>
      </section>
      <p>
        Also, have a try with CSS styles...
        <section class="practice" id="devTools2Practice">
          <h4>Try it yourself!</h4>

          Use devtools to modify the styles of contents below.
          <br>


          <div class="target">
            This is a simple text. <span id="devTools2T1" class="emphasized-text">This sentence should be red.</span>
            <span id="devTools2T2" class="hidden-text">This sentence shouldn't be visible.</span>
          </div>

          <button>Check your answer</button>
          <span class="hint"></span>
        </section>
      </p>
      <h3>Network tab</h3>
      When it comes to frontend, speed is the most important factor. Poorly designed webpages can take a minute to load, leading to awful user experience.
      There're too much to talk about when it comes to page speed optimization - we won't cover it today, because some tricks can be advanced.
      However, you can have a basic idea about such optimization by simply navigating to "network" tab.
      <section class="practice" id="devTools3Practice">
        <h4>Question</h4>
        <p>
          How many font files are loaded by this page? <input type="number" class="target">
        </p>
        <button>Check your answer</button>
        <span class="hint"></span>
      </section>
      <h3>Debugging</h3>
      The debugging tab can help with your debugging process. Have a try with the example below.
      <section class="practice" id="devTools4Practice">
        <h4>Try it yourself!</h4>
        <p>
          The correct answer is "foo". Change the JavaScript code underneath so any non-empty string is a correct answer.
          <input type="text" class="target">
        </p>
        <button>Check your answer</button>
        <span class="hint"></span>
      </section>
      <!-- Show how to use manually -->
    </section>
    <section>
      <h2>JavaScript</h2>
      <p>
        Many find JavaScript to be annoying, but after understanding its basics you may feel like saved.
        If used properly, its dynamic weak typing can actually accelerate your development, despite some drawbacks.
        <h3>Common Pitfalls and Solutions</h3>
        <div class="center">
          <img src="./img/coercion.jpg" alt="JavaScript Coercion Meme">
        </div> 
        <h4>Null and Undefined</h4>
        JavaScript has 2 categories of nullish values. One is <code>null</code> and another is <code>undefined</code>.
        However they are used in different ways. While <code>undefined</code> are usually used as a default value if nothing has been specified
        explicitly, <code>null</code> is used as a default value for objects.
<pre class="hljs lang-javascript">
> typeof null
'object'
> typeof undefined
'undefined'</pre>
        You should be very careful with arguments of a function: they can be nullish values!
        <p>
          Useful operators when dealing with nullish values.
          Newer versions of JavaScript introduced some operators to simplify the handling of nullish values. The first is optional chaining(<code>?.</code>):
        </p>
<pre class="hljs lang-javascript">
> function hasDimension(options) { return typeof (options?.dimension) == 'number'; }
> hasDimension(null)
false
> hasDimension({})
false
> hasDimension({ dimension: 4 })
true
</pre>
        Another operator is the nullish coalescing operator(<code>??</code>). This can provide a default value in case of nullish variables:
<pre class="hljs lang-javascript">
> const options = { distance: 'minkovski' }
> const dim = options.dimension ?? 2 
> dim // Suppose we'd like to provide a default in case of nullish values
2
> options.dimension || 2 // interesting enough, || also works here! However, limits apply.
2
> options.dimension = 0
0
> options.dimension ?? 2 // Output is 0 !!!
0
> options.dimension || 2 // This is WRONG.
2
</pre>
        Before <code>??</code> is a thing, programmers used <code>||</code>.
        Its truthy value is calculated after converting each operand into boolean variables.
        However, its return value is selected from original operands.

        <p>
          Note: not every browser support these operators, but modern ones do.
          Notoriously, Internet Explorer do not support them. (btw who on earth is still using IE?)
        </p>

        <h4>Basic types</h4>
        The types below are the basic types in JavaScript. 
        <ul>
          <li>String</li>
          <li>Boolean</li>
          <li>Number</li>
          <li>BigInt</li>
          <li>Symbol</li>
          <li>Function</li>
          <li>Object</li>
          <li>Null</li>
          <li>Undefined</li>
        </ul>
        Some common mistakes: first, pay attention to comparision and arithmetic operators.
        Quirks are that numbers can be casted into strings, and booleans can be casted into numbers.
<pre class="hljs lang-javascript">
> 1 == true
true
> 0 == +null // + is a unary operator
true
> 6 == '6'
true
> 1+2+3+4+5+'6'
'156'</pre>
To avoid these behaviors, you should change your <code>&equals;&equals;</code>'s into <code>&equals;&equals;&equals;</code>'s.
<pre class="hljs lang-javascript">
> 6 == '6'
true
> 6 === '6'
false
</pre>
      </p>
      What's more, avoid using the <code>typeof</code> operator on complex objects, since they'll always return <code>"object"</code>.
<pre class="hljs lang-javascript">
> typeof (new Array())
'object'
> typeof (new Date())
'object'
> typeof (new Set())
'object'</pre>
      Instead, you should use <code>instanceof</code>:
<pre class="hljs lang-javascript">
> const array = new Array()
> array instanceof Array
true
> array instanceof Object
true
> array instanceof Date
false</pre>
      <section class="practice" id="jsNullishPractice">
        <h4>Try it yourself!</h4>

        <p>
          The following function calculated the distance to origin of a point \(u \in \R^n\), which is given as an array of numbers
          (if its not an array, or its length is 0, return undefined). 
          The third argument of the function is an object (possibly null!) containing options for the function. If the 3rd argument contains 
          <code>distance: "manhattan"</code> then the Manhattan distance should be calculated. If  
          <code>distance: "minkovski"</code> then the Minkovski distance should be calculated.
          Otherwise(i.e. it does not contain <code>distance</code>, or <code>options == null</code>), the Euclidean distance will be calculated.
        </p>
        <p>
          In the case of Minkovski distance,
          if another property <code>dimension</code> is given, then it will be used as the parameter \( p \) for Minkovski distance;
          otherwise it will fall back to \( p = 2 \), which is just Euclidean distance.
        </p>
        \begin{align}
        \text{ManhattanDistance}(u) &= \sum |u_i|\\
        \text{MinkovskiDistance}(u) &= \left(\sum u_i^p\right)^{1/p}
        \end{align}

        several examples here:
<pre class="hljs lang-javascript">
dist(null) // return undefined
dist([]) // return undefined
dist([3, 4]) // return: 5
dist([3, 4], {}) // return: 5
dist([3, 4], {distance: "manhattan"}) // returns: 7
dist([3, 4], {distance: "minkovski"}) // returns: 5
dist([3, 4], {distance: "minkovski", dimension: 2}) // returns: 5
dist([3, 4], {distance: "minkovski", dimension: 3}) // returns: about 4.49794</pre>
        Code your solution below:
        <div class="code-filling">
<pre class="hljs lang-javascript">
function dist(vec, options) {
</pre>
        <textarea class="target"></textarea>
<pre class="hljs lang-javascript">
}
</pre>
        </div>
        <button>Check your answer</button>
        <span class="hint"></span>
      </section>
      The exercise above contains many points covered in this chapter. For your convenience, the answer is listed below.
      <details>
        <summary>A Possible Solution</summary>
<pre class="hljs lang-javascript">
function dist(vec, options) { // this line has been written for you.
  if (! (vec instanceof Array) || vec.length == 0) {
    return
  }
  const distanceType = options?.distance ?? "euclidean"
  let dimension = options?.dimension ?? 2

  switch (distanceType) {
    case "manhattan":
      return vec.reduce((s, x) => s + Math.abs(x))
    case "euclidean":
      dimension = 2
    case "minkovski":
      return Math.pow(vec.reduce((s, x) => s + Math.pow(x, dimension), 0),
                      1.0 / dimension)
  }
} // this line has been written for you.</pre>
      </details>
      <h4>Object Inheritance</h4>
      <p>
        In JavaScript, object inheritance, which is based on <i>prototype</i> rather than <i>classes</i>,
        is far different from traditional Object-Oriented practices. In fact there's no real "classes" in JavaScript!
        Each object is created with a function (and of course, <code>new</code> operator).
        When a property is not found on an object, a search along the prototype chain is performed. 
        <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain">Read more about this on MDN</a>.
      </p>
      <p>
        However, newer JavaScript language specifications have defined the keyword <code>class</code> and <code>extends</code>,
        which can be used to emulate the behavior of inheritance based on classes.
      </p> <!-- Speaker Note: Talk about the prototype chain in Node.js! Compare both ways of inheritance -->
<pre class="hljs lang-javascript">
class Vec2D {
  constructor (x = 0, y = 0) { // default parameter in case of undefined
    this.x = x; this.y = y;
  }
  length () {
    return Math.sqrt(x * x + y * y)
  }
}</pre>
      <p>
        Another thing which is worth noticing is the <code>this</code> keyword.
        If a method of an object is called (e.g. <code>obj.foo()</code>), <code>this</code> is binded
        to the method itself (i.e. <code>obj</code>) in the function body. However <code>this</code> can also be manually binded.
      </p>
<pre class="hljs lang-javascript">
const obj = {
  foo: 1
}
function testThis() {
  console.log(this)
}
testThis.apply(obj) // output is { foo: 1 }</pre>
      <p>
        There are actually 2 types of function in JavaScript, that is, "normal" functions and "arrow" functions. Arrow functions can be created like this:
<pre class="hljs lang-javascript">
const logEvent = (event) => { console.log(event.target) }
// logEvent is an arrow function (pay attention to curly braces)
const xPlus2 = x => x + 2
// xPlus2 receives a number and add 2 to it, then return the added value
// there's no curly braces, hence the value of the expression after => is returned.
</pre>
        Attention: You cannot bind <code>this</code> to an arrow function. They actually do not have their own lexical <code>this</code>.
<pre class="hljs lang-javascript">
const obj = {
  foo: 1
}
function testThis() {
  const t = (() => {
    console.log(this)
  }).bind({baz: 2}) // this will NOT work
  t()
}
testThis.apply(obj) // output is still { foo: 1 }</pre>
      </p>
      <h4>Syntactic Sugar üç¨</h4>
      Talk is cheap, just look at the code below!
<pre class="hljs lang-javascript">
/* Object related */
const baz = 'foobar'
const obj = {
  foo () { // no need to write `"foo": function()`
    return 'bar'
  },
  bar: 1, // quotation marks in keys can be omitted in most cases
  baz // equivalent to "baz": baz
}

/* Unpacking */
const { bar } = obj // now bar == 1
const arr = [6, 2, 1]
const [a0, a1] = arr // now a0 == 6, a1 == 2, arr[2] is discarded
const powArgs = [3, 2]
console.log(Math.pow(...powArgs)) // argument unpacking, output is 9
function testFunc(...args) {
  console.log(args.length) // now args is an array containing all arguments.
  // NOTE: use this to replace the use of `arguments`
}
testFunc(3, 4, 5) // output is 3

/* For loops */
for (let index in arr) { // in -> index
  console.log(index)
} // 0 1 2
for (let value of arr) { // in -> index
  console.log(value)
} // 6 2 1
</pre>
      <h4>Hoisting</h4>
      Let's just start with a question:
      <section class="practice" id="jsHoistingPractice">
        <h4>Question</h4>
<pre class="hljs lang-javascript">
function main() {
  var output = ''
  for (var i = 1; i <= 3; i++) {
  setTimeout(() => {output += String(i)}, 1000)
  }
  setTimeout(() => console.log(output), 1500)
}
main()</pre>
        <p>
          What's the output of the code above? <input type="text" class="target">
        </p>
        <button>Check your answer</button>
        <span class="hint"></span>
      </section>
      Variable declared with the keyword <code>var</code> have 2 types of lexical scopes.
      <ul>
        <li>
          Global Scope(when declared outside of any function):
          the variable then becomes a property of <code>globalThis</code>
          (<code>window</code> in browsers and <code>global</code> in Node.js)
        </li>
        <li>
          Functional Scope(when declared in a function):
          the variable is accessible in the whole function
        </li>
      </ul>
      <p>
        There're no other scopes, and particularly, JavaScript will not create a new lexical scope of <code>var</code> for each pair of curly braces.
      </p>
      <p>
        An approximated mental model of <code>var</code>'s is: 
        just consider all their declarations are moved to the start of function (or start of file) before any code is executed.
      </p>
      <p>
        Most of the cases hoisting is not the expected behavior. Switching to let / const:
<pre class="hljs lang-javascript">
{
  let a = 1
  // console.log(b); // error!
  {
    let b = 2
    console.log(b)
  }
}
//console.log(a) // error!
const c = 4
//c = 5 // error!
const obj = {}
obj.foo = 'bar' // this works because the reference to object is not changed 
</pre>
        They just behave like variables in most languages, and global variabled declared with let / const will not become a property of <code>globalThis</code>. Sweet.
      </p>
      <h4>MapReduce</h4>
      The methods map/forEach/reduce exist on any array instance (again, in modern browsers).
      Use them instead of for loops to simplify your code.
<pre class="hljs lang-javascript">
const arr = [1, 2, 3, 4]
console.log(arr.map(x => x + 2)) // [3, 4, 5, 6]
console.log(arr.reduce((s, x) => s + x)) // sum is 10
</pre>
      For more <abbr title="Functional Programming">FP</abbr>-style functions, try <a href="https://www.npmjs.com/package/lodash">lodash</a>.

      <h4>Promise and Async functions</h4>
      <!-- How promises work; how to declare async functions -->
      <h4>A Brief Explanation on Package Management</h4>
      <!-- script tags -> requirejs -> adapted commonjs style require -> bundlers like webpack -> ES6 imports (deno?) -->
      <h4>Useful APIs</h4>
      Since the time of this workshop is limited, we'll only have a look at <code>Element.querySelector</code> and <code>fetch</code>.
      <h4>Event propagation in DOMs</h4>
      <!-- History. Provide a link. bubbling and capturing-->
    </section>
    <script src="./js/main.mjs" type="module"></script>
  </body>
</html>
